# 第32课：谱聚类——无需指定簇数量的聚类

**谱聚类(Spectral Clustering)**

* 无向权重图
* 相似矩阵
* 拉普拉斯矩阵
* 无向图切图
* RatioCut切图
* Ncut

**谱聚类算法流程**

* 1、根据输入的相似矩阵的生成方式构建样本的相似矩阵S
* 2、根据矩阵S构建邻接矩阵W，构建度矩阵D
* 3、计算出拉普拉斯矩阵L
* 4、构建标准化后的拉普拉斯矩阵 D**(-1/2) *L * D **(-1/2)  
* 5、计算上面值最小的k1个特征值所各自对应的特征向量f
* 6、将特征向量f标准化，最终组成n*k1维的特征矩阵F
* 7、对F中的每一行作为一个k1维的样本，共n个样本,用输入的聚类方法进行聚类，聚类维度为k2
* 8、得到簇划分C(c1,c2..ck2)

**SpectralClustering重要参数：**

* n_clusters：谱聚类切图时降维到的维数
* affinity：似矩阵的建立方式
  * 第一类 是 'nearest _neighbors'即K邻近法。
  * 第二类是'precomputed'即自定义相似矩阵。选择自定义相似矩阵时，需要自己调用set_params来自己设置相似矩阵。
  * 第三类是全连接法，可以使用各种核函数来定义相似矩阵，还可以自定义核函数。最常用的是内置高斯核函数'rbf'。其他比较流行的核函数有‘linear’即线性核函数, ‘poly’即多项式核函数, ‘sigmoid’即sigmoid核函数。如果选择了这些核函数， 对应的核函数参数在后面有单独的参数需要调。自定义核函数我没有使用过，这里就不多讲了。affinity默认是高斯核'rbf'。一般来说，相似矩阵推荐使用默认的高斯核函数
* gamma：核函数参数，如果在affinity中使用了核函数，这里便可以调参
* kernel_params: 自定义核函数的参数
* n_neighbors: 如果affinity选择的为K近邻算法，这个便可以传入K
* n_init:使用K-Means时用不同的初始值组合跑K-Means聚类的次数，这个和K-Means类里面n_init的意义完全相同，默认是10，一般使用默认值就可以
* 等等

　**谱聚类算法的优缺点：**

* 优点：
  * 谱聚类只需要数据之间的相似度矩阵，因此对于处理稀疏数据的聚类很有效。这点传统聚类算法比如K-Means很难做到
  * 由于使用了降维，因此在处理高维数据聚类时的复杂度比传统聚类算法好。
* 缺点:
  * 如果最终聚类的维度非常高，则由于降维的幅度不够，谱聚类的运行速度和最后的聚类效果均不好。
  * 聚类效果依赖于相似矩阵，不同的相似矩阵得到的最终聚类效果可能很不同。